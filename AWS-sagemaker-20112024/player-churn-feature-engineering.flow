{"metadata": {"version": 1, "disable_limits": false, "instance_type": "ml.m5.4xlarge", "disable_validation": true}, "parameters": [], "nodes": [{"node_id": "a2f1a8c7-4d93-4a80-bbc9-7c068441682a", "type": "SOURCE", "operator": "sagemaker.s3_source_0.1", "parameters": {"dataset_definition": {"datasetSourceType": "Canvas Dataset", "name": "player_churn", "description": null, "s3ExecutionContext": {"s3Uri": "s3://sagemaker-us-east-1-453765616413/Canvas/studio-user-76f7a9d0/Datasets/24a42780-b87c-4375-8147-35ba3e245b90/1732109842.458171/player_churn/output_1732109851", "s3ContentType": "csv", "s3HasHeader": true, "s3FieldDelimiter": ",", "s3DirIncludesNested": false, "s3AddsFilenameColumn": false, "s3RoleArn": null, "s3CsvEncodingType": null, "s3SkipLines": 0, "s3MultiLine": null, "s3DataType": "S3Prefix", "s3ManifestPlain": {"s3Uris": null}}, "canvasDatasetMetadata": {"datasetId": "24a42780-b87c-4375-8147-35ba3e245b90", "version": 1732109842.458171, "versionSequenceNum": 1}}}, "inputs": [], "outputs": [{"name": "default", "sampling": {"sampling_method": "sample_by_count", "sample_size": 50000}}]}, {"node_id": "9e82754c-7b07-455c-95e3-efaa4174bfbc", "type": "TRANSFORM", "operator": "sagemaker.spark.infer_and_cast_type_0.1", "parameters": {}, "trained_parameters": {"schema": {"player_id": "string", "cohort_id": "string", "cohort_day_of_week": "long", "player_type": "string", "player_lifetime": "long", "session_count": "long", "player_churn": "bool", "begin_session_count_last_day_1": "long", "end_session_count_last_day_1": "long", "begin_session_count_last_day_2": "long", "end_session_count_last_day_2": "long", "begin_session_count_last_day_3": "long", "end_session_count_last_day_3": "long", "begin_session_count_last_day_4": "long", "end_session_count_last_day_4": "long", "begin_session_count_last_day_5": "long", "end_session_count_last_day_5": "long", "begin_session_count_last_day_6": "long", "end_session_count_last_day_6": "long", "begin_session_count_last_day_7": "long", "end_session_count_last_day_7": "long", "begin_session_count_last_week_1": "long", "end_session_count_last_week_1": "long", "begin_session_count_last_week_2": "long", "end_session_count_last_week_2": "long", "begin_session_count_last_week_3": "long", "end_session_count_last_week_3": "long", "begin_session_count_last_month_1": "long", "end_session_count_last_month_1": "long", "begin_session_count_last_month_2": "long", "end_session_count_last_month_2": "long", "begin_session_time_of_day_mean_last_day_1": "long", "end_session_time_of_day_mean_last_day_1": "long", "begin_session_time_of_day_mean_last_day_2": "long", "end_session_time_of_day_mean_last_day_2": "long", "begin_session_time_of_day_mean_last_day_3": "long", "end_session_time_of_day_mean_last_day_3": "long", "begin_session_time_of_day_mean_last_day_4": "long", "end_session_time_of_day_mean_last_day_4": "long", "begin_session_time_of_day_mean_last_day_5": "long", "end_session_time_of_day_mean_last_day_5": "long", "begin_session_time_of_day_mean_last_day_6": "long", "end_session_time_of_day_mean_last_day_6": "long", "begin_session_time_of_day_mean_last_day_7": "long", "end_session_time_of_day_mean_last_day_7": "long", "begin_session_time_of_day_mean_last_week_1": "long", "end_session_time_of_day_mean_last_week_1": "long", "begin_session_time_of_day_mean_last_week_2": "long", "end_session_time_of_day_mean_last_week_2": "long", "begin_session_time_of_day_mean_last_week_3": "long", "end_session_time_of_day_mean_last_week_3": "long", "begin_session_time_of_day_mean_last_month_1": "long", "end_session_time_of_day_mean_last_month_1": "long", "begin_session_time_of_day_mean_last_month_2": "long", "end_session_time_of_day_mean_last_month_2": "long", "begin_session_time_of_day_std_last_day_1": "string", "end_session_time_of_day_std_last_day_1": "string", "begin_session_time_of_day_std_last_day_2": "long", "end_session_time_of_day_std_last_day_2": "long", "begin_session_time_of_day_std_last_day_3": "long", "end_session_time_of_day_std_last_day_3": "long", "begin_session_time_of_day_std_last_day_4": "long", "end_session_time_of_day_std_last_day_4": "long", "begin_session_time_of_day_std_last_day_5": "long", "end_session_time_of_day_std_last_day_5": "long", "begin_session_time_of_day_std_last_day_6": "long", "end_session_time_of_day_std_last_day_6": "long", "begin_session_time_of_day_std_last_day_7": "long", "end_session_time_of_day_std_last_day_7": "long", "begin_session_time_of_day_std_last_week_1": "long", "end_session_time_of_day_std_last_week_1": "long", "begin_session_time_of_day_std_last_week_2": "long", "end_session_time_of_day_std_last_week_2": "long", "begin_session_time_of_day_std_last_week_3": "long", "end_session_time_of_day_std_last_week_3": "long", "begin_session_time_of_day_std_last_month_1": "long", "end_session_time_of_day_std_last_month_1": "long", "begin_session_time_of_day_std_last_month_2": "long", "end_session_time_of_day_std_last_month_2": "long"}}, "inputs": [{"name": "default", "node_id": "a2f1a8c7-4d93-4a80-bbc9-7c068441682a", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "da23c085-7159-4b28-a9ec-e91873c3370a", "type": "VISUALIZATION", "operator": "sagemaker.visualizations.data_insights_report_0.1", "parameters": {"name": "20-11-2024_13:38:36", "insights_report_parameters": {"target_column": "player_churn", "problem_type": "Classification"}, "full_data": "false"}, "inputs": [{"name": "df", "node_id": "9e82754c-7b07-455c-95e3-efaa4174bfbc", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "60f6ac09-622f-4037-ad61-1465f18d2db6", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_code_0.1", "parameters": {"operator": "Python (Pandas)", "pandas_parameters": {"code": "# Table is available as variable `df`\ncols = ['cohort_day_of_week',\n'begin_session_time_of_day_std_last_week_1',\n'player_lifetime',\n'begin_session_time_of_day_mean_last_day_1',\n'end_session_time_of_day_mean_last_week_1',\n'begin_session_time_of_day_mean_last_week_1',\n'cohort_id',\n'player_type',\n'begin_session_time_of_day_std_last_day_1',\n'end_session_time_of_day_mean_last_day_1',\n'begin_session_time_of_day_mean_last_day_2',\n'end_session_time_of_day_std_last_week_1',\n'end_session_time_of_day_std_last_day_1',\n'session_count',\n'end_session_time_of_day_mean_last_day_3',\n'begin_session_time_of_day_mean_last_day_3',\n'end_session_time_of_day_mean_last_day_2',\n'player_churn',\n'player_id']\n\ndf.drop(columns=[x for x in df.columns if x not in cols], inplace=True)\n"}, "pyspark_parameters": {}, "name": "bulk drop columns"}, "inputs": [{"name": "df", "node_id": "9e82754c-7b07-455c-95e3-efaa4174bfbc", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "1cf5b934-b247-4534-b895-563dafedea3d", "type": "TRANSFORM", "operator": "sagemaker.spark.manage_columns_0.1", "parameters": {"operator": "Drop column", "drop_column_parameters": {"column_to_drop": ["cohort_day_of_week"]}}, "inputs": [{"name": "df", "node_id": "60f6ac09-622f-4037-ad61-1465f18d2db6", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "4348f7da-6876-445e-8da5-abcc89f63acd", "type": "TRANSFORM", "operator": "sagemaker.spark.handle_missing_0.1", "parameters": {"operator": "Fill missing", "fill_missing_parameters": {"input_column": ["begin_session_time_of_day_std_last_week_1", "begin_session_time_of_day_std_last_day_1", "end_session_time_of_day_std_last_week_1", "end_session_time_of_day_std_last_day_1"], "fill_value": "0"}, "impute_parameters": {"column_type": "Numeric", "numeric_parameters": {"strategy": "Approximate Median"}}}, "inputs": [{"name": "df", "node_id": "1cf5b934-b247-4534-b895-563dafedea3d", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "a4dd9cc7-e016-40c0-9291-904f89259485", "type": "TRANSFORM", "operator": "sagemaker.spark.balance_data_0.1", "parameters": {"operator": "Random oversample", "ratio": 1, "smote_params": {"num_neighbors": 5}, "target_column": "player_churn"}, "inputs": [{"name": "df", "node_id": "4348f7da-6876-445e-8da5-abcc89f63acd", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "a460adce-4f46-46d6-90f5-5734990695a0", "type": "TRANSFORM", "operator": "sagemaker.spark.encode_categorical_0.1", "parameters": {"operator": "One-hot encode", "one_hot_encode_parameters": {"input_column": ["player_type", "cohort_id"], "invalid_handling_strategy": "Keep", "drop_last": false, "output_style": "Columns"}, "ordinal_encode_parameters": {"invalid_handling_strategy": "Replace with NaN"}}, "inputs": [{"name": "df", "node_id": "a4dd9cc7-e016-40c0-9291-904f89259485", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "23b21386-4574-44e4-88ab-41c86bf694f2", "type": "TRANSFORM", "operator": "sagemaker.spark.cast_single_data_type_0.1", "parameters": {"column": "player_churn", "original_data_type": "Boolean", "data_type": "long"}, "inputs": [{"name": "df", "node_id": "a460adce-4f46-46d6-90f5-5734990695a0", "output_name": "default"}], "outputs": [{"name": "default"}]}, {"node_id": "9a9d10af-4ce0-4d3a-94e2-13cf0c217075", "type": "TRANSFORM", "operator": "sagemaker.spark.custom_code_0.1", "parameters": {"operator": "Python (Pandas)", "pandas_parameters": {"code": "from datetime import datetime, timezone\n\ndef generate_event_timestamp():\n    # naive datetime representing local time\n    naive_dt = datetime.now()\n    # take timezone into account\n    aware_dt = naive_dt.astimezone()\n    # time in UTC\n    utc_dt = aware_dt.astimezone(timezone.utc)\n    # transform to ISO-8601 format\n    event_time = utc_dt.isoformat(timespec='milliseconds')\n    event_time = event_time.replace('+00:00', 'Z')\n    return event_time\n\ndt = generate_event_timestamp()\ndf['event_time'] = dt"}, "pyspark_parameters": {}, "name": "create_event_timestamp"}, "inputs": [{"name": "df", "node_id": "23b21386-4574-44e4-88ab-41c86bf694f2", "output_name": "default"}], "outputs": [{"name": "default"}]}]}